<!-- To be included inside template.html -->

<div class="page-header">
    <h1>Visual peak calling How-To</h1>
</div>
<p>Visual peak calling is a semi-supervised algorithm. At first we need to train SPAN models
    for each track locally or using computational cluster. Then visualize Chip-seq signal
    tracks in JBR Genome Browser, load trained SPAN models,
    create annotations and run peak calling tuning procedure.

<div>
    <h2>Content</h2>
    <ul>
        <li><a href="#jbr-howto-prerequisites">Prerequisites</a></li>
        <li><a href="#jbr-howto-load-data">Load Data Into JBR</a></li>
        <li><a href="#jbr-howto-peak-annotating">Annotating Peaks</a></li>
        <li><a href="#jbr-howto-train">Train SPAN Models</a></li>
        <li><a href="#jbr-howto-peak-calling">Visual Peak Calling</a></li>
    </ul>
</div>
</p>

<h2 id="jbr-howto-prerequisites">Prerequisites</h2>
<p>
    Install <a href="span.html#span-installation">SPAN</a> peak caller and
    <a href="jbr.html#jbr-installation">JBR</a> Genome Browser.
</p>
<p>
    This tutorial includes all necessary data files. If you want to use it with your own
    data, you need to prepare ChIP-seq signal tracks as:
    <ul>
    <li>BAM (or BED / BED.gz) files for further processing with SPAN.</li>
    <li>BIGWIG files for visualization in JBR browser.
        <br/>
        You can convert BAM / BED signal tracks to BIGWIG using bedtools, samtools and bedGraphToBigWig utilities.</li>
    </ul>
</p>

<h2 id="jbr-howto-train">Train Models</h2>
<p>
    <mark>TODO: show cmdline args and results output sample, SPAN model files locations</mark>
</p>

<h2 id="jbr-howto-load-data">Load Data Into JBR Genome Browser</h2>
<p>
    <mark>TODO: Create session using 2 *bw tracks from http://artyomovlab.wustl.edu/, add links to
        related SPAN models. User is supposed to download models, open them in JBR browser.
    </mark>
</p>

<h2 id="jbr-howto-peak-annotating">Annotating Peaks</h2>
<p>
    <mark>TODO: How to add/remove label, export labels</mark>
    <br/>
    <mark>TODO: Labelling recommendations...</mark>
</p>

<h2 id="jbr-howto-peak-calling">Visual Peak Calling</h2>
<p>
    <mark>TODO: After you've got labels two scenarios are possible: 1) Call peaks in JBR browser 2)
        Call peaks in command line using SPAN.
        Peak calling in JBR allows you to perform peak calling tuning iteratively. E.g. annotate
        peaks, tune peak calling, validate results, if
        you're not satisfied with them, you can remove/add additional annotations and rerun tuning.
        Tuning in cmdline could be convenient if you are sure of your annotations, so you could do peak
        calling
        as part of your pipeline script. In this case rerun SPAN with --labels options.
        Also you can pass --labels while training model, SPAN will tune peak calling arguments and
        call peaks after model training
    </mark>
    <mark>TODO: Suggest to run tune action in JBR. Also describe how to change FDR, GAP and do
        peak calling manually.
    </mark>
    <br/>
    <mark>TODO: Optionally suggest to open our labels and try peak calling tuning to view rescued
        tracks
    </mark>
</p>.
